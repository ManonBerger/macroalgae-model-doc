{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to Macroalgae PISCES Module This is the documentation for the Macroalgae module integrated to PISCES ocean biogeochemical model ( PISCES model ). See the model description for more details.","title":"Home"},{"location":"#welcome-to-macroalgae-pisces-module","text":"This is the documentation for the Macroalgae module integrated to PISCES ocean biogeochemical model ( PISCES model ). See the model description for more details.","title":"Welcome to Macroalgae PISCES Module"},{"location":"Model/Production/","text":"Macroalgae Primary Production This module simulates the net primary production of macroalgae , distinguishing between two functional types: Temperate Brown Macroalgae Tropical Red Macroalgae Light, temperature, nutrient, and iron limitations are considered to compute the net primary production (NPP) . Model Structure For each 3D ocean grid cell where macroalgae can grow ( macrogebco > 0 ), the following processes are computed: Growth Limitations 1. Temperature Dependence The temperature growth limitation is given by a Gaussian function, following Wu et al (2023): f_T = \\exp\\left(-2.3 \\left(\\frac{T - T_{\\text{opt}}}{T_x - T_{\\text{opt}}}\\right)^2 \\right) Where: T : in situ temperature T_{\\text{opt}} : optimal temperature T_x : limiting temperature (either xtmax or xtmin ) 2. Light Limitation Light limitation uses a peaked function: f_{\\text{PAR}} = \\left( \\frac{E}{E_{\\text{opt}}} \\right) \\cdot \\exp\\left(1 - \\frac{E}{E_{\\text{opt}}} \\right) Where: - E : total PAR at depth - E_{\\text{opt}} : optimal light for macroalgae 3. Nutrient Limitation (Michaelis-Menten) Nitrogen (NO\u2083) and phosphorus (PO\u2084) limitations are computed: L_{NO_3} = \\frac{[NO_3]}{K_{NO_3} + [NO_3]} \\quad ; \\quad L_{PO_4} = \\frac{[PO_4]}{K_{PO_4} + [PO_4]} Combined as: f_{\\text{nutrient}} = \\min(L_{NO_3}, L_{PO_4}) 4. Iron Limitation Based on Paine et al. (2023): f_{Fe} = f_{Fe}^{\\text{max}} \\cdot \\frac{[Fe]}{K_{Fe} + [Fe]} Then: f_{\\text{nut}} = \\min(f_{\\text{nutrient}}, f_{Fe}) Gross Production Gross primary production: \\frac{dB}{dt} = \\mu_{\\text{max}} \\cdot f_T \\cdot f_{\\text{nut}} \\cdot f_{\\text{PAR}} \\cdot \\Delta t Then corrected for sea ice cover : \\frac{dB}{dt} = \\frac{dB}{dt} \\cdot (1 - \\text{frac}_{\\text{ice}}) Respiration Respiration is temperature-dependent: R = \\mu_{\\text{resp}} \\cdot \\text{coef}_{\\text{resp}}^{T - 20} \\cdot \\frac{dB}{dt} Net Primary Production Finally, NPP is computed as: \\text{NPP} = (\\frac{dB}{dt} - R) \\cdot \\text{biomass tracer mask} Nutrient Update The uptake of nutrients (PO\u2084, NO\u2083, DIC, Fe) is proportional to the NPP and stoichiometric ratios. Variable Mapping Variable in Fortran Description Equation Symbol ts Temperature T etot Light at depth E tr(...,jpno3,...) NO\u2083 concentration [NO_3] tr(...,jppo4,...) PO\u2084 concentration [PO_4] tr(...,jpfer,...) Iron concentration [Fe] fr_i Sea ice fraction \\text{frac}_{\\text{ice}} trbtropred , trbtempbrown Biomass array B macrogebco(:,:,:) Bathymetry mask (% cell area) \\text{mask}_{3D}(:,:,:) xstep Time step \\Delta t Input Parameters (from nampismacprod namelist) Variable in Fortran Description Equation Symbol toptmacb , toptmacr Optimal temperature T_{\\text{opt}} xtmaxmacb , xtminmacb Temperature limits (brown) T_x xparoptmacb , xparoptmacr Optimal light E_{\\text{opt}} concmno3b , concmno3r NO\u2083 half-sat. constants K_{NO_3} concmpo4b , concmpo4r PO\u2084 half-sat. constants K_{PO_4} concmfe Fe half-sat. constant K_{Fe} xfegmacmax Fe limitation max factor f_{Fe}^{\\text{max}} xgmacmaxb , xgmacmaxr Max growth rate \\mu_{\\text{max}} xrpmacmax Max respiration rate \\mu_{\\text{resp}} xrespmaccoef Respiration temp. coefficient \\text{coef}_{\\text{resp}} References Wu et al., 2023. Paine et al., 2023. Output Variables These variables are output using iom_put : Output Description MACPRODB Gross production (Brown) MACPRODR Gross production (Red) MACNPPB Net primary production (Brown) MACNPPR Net primary production (Red) MACNPP Total net primary production MACRESP Respiration (all macroalgae)","title":"Production"},{"location":"Model/Production/#macroalgae-primary-production","text":"This module simulates the net primary production of macroalgae , distinguishing between two functional types: Temperate Brown Macroalgae Tropical Red Macroalgae Light, temperature, nutrient, and iron limitations are considered to compute the net primary production (NPP) .","title":"Macroalgae Primary Production"},{"location":"Model/Production/#model-structure","text":"For each 3D ocean grid cell where macroalgae can grow ( macrogebco > 0 ), the following processes are computed:","title":"Model Structure"},{"location":"Model/Production/#growth-limitations","text":"","title":"Growth Limitations"},{"location":"Model/Production/#1-temperature-dependence","text":"The temperature growth limitation is given by a Gaussian function, following Wu et al (2023): f_T = \\exp\\left(-2.3 \\left(\\frac{T - T_{\\text{opt}}}{T_x - T_{\\text{opt}}}\\right)^2 \\right) Where: T : in situ temperature T_{\\text{opt}} : optimal temperature T_x : limiting temperature (either xtmax or xtmin )","title":"1. Temperature Dependence"},{"location":"Model/Production/#2-light-limitation","text":"Light limitation uses a peaked function: f_{\\text{PAR}} = \\left( \\frac{E}{E_{\\text{opt}}} \\right) \\cdot \\exp\\left(1 - \\frac{E}{E_{\\text{opt}}} \\right) Where: - E : total PAR at depth - E_{\\text{opt}} : optimal light for macroalgae","title":"2. Light Limitation"},{"location":"Model/Production/#3-nutrient-limitation-michaelis-menten","text":"Nitrogen (NO\u2083) and phosphorus (PO\u2084) limitations are computed: L_{NO_3} = \\frac{[NO_3]}{K_{NO_3} + [NO_3]} \\quad ; \\quad L_{PO_4} = \\frac{[PO_4]}{K_{PO_4} + [PO_4]} Combined as: f_{\\text{nutrient}} = \\min(L_{NO_3}, L_{PO_4})","title":"3. Nutrient Limitation (Michaelis-Menten)"},{"location":"Model/Production/#4-iron-limitation","text":"Based on Paine et al. (2023): f_{Fe} = f_{Fe}^{\\text{max}} \\cdot \\frac{[Fe]}{K_{Fe} + [Fe]} Then: f_{\\text{nut}} = \\min(f_{\\text{nutrient}}, f_{Fe})","title":"4. Iron Limitation"},{"location":"Model/Production/#gross-production","text":"Gross primary production: \\frac{dB}{dt} = \\mu_{\\text{max}} \\cdot f_T \\cdot f_{\\text{nut}} \\cdot f_{\\text{PAR}} \\cdot \\Delta t Then corrected for sea ice cover : \\frac{dB}{dt} = \\frac{dB}{dt} \\cdot (1 - \\text{frac}_{\\text{ice}})","title":"Gross Production"},{"location":"Model/Production/#respiration","text":"Respiration is temperature-dependent: R = \\mu_{\\text{resp}} \\cdot \\text{coef}_{\\text{resp}}^{T - 20} \\cdot \\frac{dB}{dt}","title":"Respiration"},{"location":"Model/Production/#net-primary-production","text":"Finally, NPP is computed as: \\text{NPP} = (\\frac{dB}{dt} - R) \\cdot \\text{biomass tracer mask}","title":"Net Primary Production"},{"location":"Model/Production/#nutrient-update","text":"The uptake of nutrients (PO\u2084, NO\u2083, DIC, Fe) is proportional to the NPP and stoichiometric ratios.","title":"Nutrient Update"},{"location":"Model/Production/#variable-mapping","text":"Variable in Fortran Description Equation Symbol ts Temperature T etot Light at depth E tr(...,jpno3,...) NO\u2083 concentration [NO_3] tr(...,jppo4,...) PO\u2084 concentration [PO_4] tr(...,jpfer,...) Iron concentration [Fe] fr_i Sea ice fraction \\text{frac}_{\\text{ice}} trbtropred , trbtempbrown Biomass array B macrogebco(:,:,:) Bathymetry mask (% cell area) \\text{mask}_{3D}(:,:,:) xstep Time step \\Delta t","title":"Variable Mapping"},{"location":"Model/Production/#input-parameters-from-nampismacprod-namelist","text":"Variable in Fortran Description Equation Symbol toptmacb , toptmacr Optimal temperature T_{\\text{opt}} xtmaxmacb , xtminmacb Temperature limits (brown) T_x xparoptmacb , xparoptmacr Optimal light E_{\\text{opt}} concmno3b , concmno3r NO\u2083 half-sat. constants K_{NO_3} concmpo4b , concmpo4r PO\u2084 half-sat. constants K_{PO_4} concmfe Fe half-sat. constant K_{Fe} xfegmacmax Fe limitation max factor f_{Fe}^{\\text{max}} xgmacmaxb , xgmacmaxr Max growth rate \\mu_{\\text{max}} xrpmacmax Max respiration rate \\mu_{\\text{resp}} xrespmaccoef Respiration temp. coefficient \\text{coef}_{\\text{resp}}","title":"Input Parameters (from nampismacprod namelist)"},{"location":"Model/Production/#references","text":"Wu et al., 2023. Paine et al., 2023.","title":"References"},{"location":"Model/Production/#output-variables","text":"These variables are output using iom_put : Output Description MACPRODB Gross production (Brown) MACPRODR Gross production (Red) MACNPPB Net primary production (Brown) MACNPPR Net primary production (Red) MACNPP Total net primary production MACRESP Respiration (all macroalgae)","title":"Output Variables"},{"location":"Model/Remineralisation/","text":"Remineralization of Macroalgal DOC This is a description of p4zrem.F90 . To incorporate the remineralization of dissolved organic carbon from macroalgal origin ( DOCMAC ) into the biogeochemical model, we extended the existing remineralization scheme\u2014originally limited to phytoplankton-derived DOC. This document summarizes the added formulations and their stoichiometric interpretation. 1. Fraction of Macroalgal DOC We first calculate the fraction of total DOC originating from macroalgae: f_{DOCmac} = \\frac{DOC_{mac}}{DOC + DOC_{mac} + \\varepsilon} Here, \\varepsilon is a small number to prevent division by zero. 2. Remineralization Fluxes Oxic, suboxic and anoxic remineralization are computing as in PISCES std with DOC + DOCMAC . 3. Total Remineralization Flux The total remineralization flux is the sum of all pathways: R_{tot} =R_{oxic} + R_{denit} + R _{ano} 4. DOC and DOC_mac Evolution Remineralization is split between the phytoplankton-derived DOC and macroalgal DOC pools using f_{DOCmac} : \\frac{dDOC}{dt} = -R_{tot} \\cdot (1 - f_{DOCmac}) \\frac{dDOC_{mac}}{dt} = -R_{tot} \\cdot f_{DOCmac} 5. Remineralization Products Dissolved Inorganic Carbon (DIC) All remineralized DOC contributes to DIC: \\frac{dDIC}{dt} = + R_{tot} Oxygen Only consumed in oxic remineralization: \\frac{dO_2}{dt} = - R_{oxic} \\cdot r_{O_2} Nitrate and Ammonium Stoichiometry accounts for distinct C:N ratios of phytoplankton and macroalgae: \\frac{dNO_3^-}{dt} = - R_{denit} \\cdot r_{denit} \\cdot \\left[(1 - f_{DOCmac}) + f_{DOCmac} \\cdot \\frac{Q_{C:N}^{PHY}}{Q_{C:N}^{MAC}}\\right] \\frac{dNH_4^+}{dt} = + R_{tot} \\cdot \\left[(1 - f_{DOCmac}) + f_{DOCmac} \\cdot \\frac{Q_{C:N}^{PHY}}{Q_{C:N}^{MAC}}\\right] Total Alkalinity (TAl) Alkalinity changes reflect nitrate consumption and denitrification: \\frac{dTA}{dt} = + r_{NO_3} \\cdot \\left( R_{tot} + r_{denit} \\cdot R_{denit} \\right) \\cdot \\left[(1 - f_{DOCmac}) + f_{DOCmac} \\cdot \\frac{Q_{C:N}^{PHY}}{Q_{C:N}^{MAC}} \\right] Phosphate Scaled similarly using C:P ratios: \\frac{dPO_4^{3-}{dt} = + R_{tot} \\cdot \\left[(1 - f_{DOCmac}) + f_{DOCmac} \\cdot \\frac{Q_{C:P}^{PHY}}{Q_{C:P}^{MAC}} \\right] Iron (from macroalgae only) Iron is released as dissolved iron only from macroalgal DOC remineralization: \\frac{dDFe}{dt} = + R_{tot} \\cdot f_{DOCmac} \\cdot \\left( \\frac{1}{Q_{C:Fe}^{MAC}} \\right) Variables Fortran Variable Documentation / Equation Name Description xdocmacdoc f_{\\text{mac}} = \\frac{\\text{DOC}_{\\text{MAC}}}{\\text{DOC} + \\text{DOC}_{\\text{MAC}}} Fraction of total DOC from macroalgae tr(:,:,:,jpdoc,...) \\text{DOC} Classical dissolved organic carbon tr(:,:,:,jpdocmac,...) \\text{DOC}_{\\text{MAC}} DOC from macroalgae tr(:,:,:,jpoxy,...) \\text{O}_2 Dissolved oxygen tr(:,:,:,jpno3,...) \\text{NO}_3^- Nitrate tr(:,:,:,jpdic,...) \\text{DIC} Dissolved inorganic carbon tr(:,:,:,jpnh4,...) \\text{NH}_4^+ Ammonium tr(:,:,:,jptal,...) \\text{TA} Total alkalinity tr(:,:,:,jppo4,...) \\text{PO}_4^{3-} Phosphate tr(:,:,:,jpfer,...) \\text{DFe} Dissolved iron qCN_phy Q_{\\text{C:N}}^{\\text{phy}} Phytoplankton carbon-to-nitrogen ratio qCN_mac Q_{\\text{C:N}}^{\\text{mac}} Macroalgae carbon-to-nitrogen ratio qCP_phy Q_{\\text{C:P}}^{\\text{phy}} Phytoplankton carbon-to-phosphorus ratio qCP_mac Q_{\\text{C:P}}^{\\text{mac}} Macroalgae carbon-to-phosphorus ratio qCFe_mac Q_{\\text{C:Fe}}^{\\text{mac}} Macroalgae carbon-to-iron ratio","title":"Remineralisation"},{"location":"Model/Remineralisation/#remineralization-of-macroalgal-doc","text":"This is a description of p4zrem.F90 . To incorporate the remineralization of dissolved organic carbon from macroalgal origin ( DOCMAC ) into the biogeochemical model, we extended the existing remineralization scheme\u2014originally limited to phytoplankton-derived DOC. This document summarizes the added formulations and their stoichiometric interpretation.","title":"Remineralization of Macroalgal DOC"},{"location":"Model/Remineralisation/#1-fraction-of-macroalgal-doc","text":"We first calculate the fraction of total DOC originating from macroalgae: f_{DOCmac} = \\frac{DOC_{mac}}{DOC + DOC_{mac} + \\varepsilon} Here, \\varepsilon is a small number to prevent division by zero.","title":"1. Fraction of Macroalgal DOC"},{"location":"Model/Remineralisation/#2-remineralization-fluxes","text":"Oxic, suboxic and anoxic remineralization are computing as in PISCES std with DOC + DOCMAC .","title":"2. Remineralization Fluxes"},{"location":"Model/Remineralisation/#3-total-remineralization-flux","text":"The total remineralization flux is the sum of all pathways: R_{tot} =R_{oxic} + R_{denit} + R _{ano}","title":"3. Total Remineralization Flux"},{"location":"Model/Remineralisation/#4-doc-and-doc_mac-evolution","text":"Remineralization is split between the phytoplankton-derived DOC and macroalgal DOC pools using f_{DOCmac} : \\frac{dDOC}{dt} = -R_{tot} \\cdot (1 - f_{DOCmac}) \\frac{dDOC_{mac}}{dt} = -R_{tot} \\cdot f_{DOCmac}","title":"4. DOC and DOC_mac Evolution"},{"location":"Model/Remineralisation/#5-remineralization-products","text":"","title":"5. Remineralization Products"},{"location":"Model/Remineralisation/#dissolved-inorganic-carbon-dic","text":"All remineralized DOC contributes to DIC: \\frac{dDIC}{dt} = + R_{tot}","title":"Dissolved Inorganic Carbon (DIC)"},{"location":"Model/Remineralisation/#oxygen","text":"Only consumed in oxic remineralization: \\frac{dO_2}{dt} = - R_{oxic} \\cdot r_{O_2}","title":"Oxygen"},{"location":"Model/Remineralisation/#nitrate-and-ammonium","text":"Stoichiometry accounts for distinct C:N ratios of phytoplankton and macroalgae: \\frac{dNO_3^-}{dt} = - R_{denit} \\cdot r_{denit} \\cdot \\left[(1 - f_{DOCmac}) + f_{DOCmac} \\cdot \\frac{Q_{C:N}^{PHY}}{Q_{C:N}^{MAC}}\\right] \\frac{dNH_4^+}{dt} = + R_{tot} \\cdot \\left[(1 - f_{DOCmac}) + f_{DOCmac} \\cdot \\frac{Q_{C:N}^{PHY}}{Q_{C:N}^{MAC}}\\right]","title":"Nitrate and Ammonium"},{"location":"Model/Remineralisation/#total-alkalinity-tal","text":"Alkalinity changes reflect nitrate consumption and denitrification: \\frac{dTA}{dt} = + r_{NO_3} \\cdot \\left( R_{tot} + r_{denit} \\cdot R_{denit} \\right) \\cdot \\left[(1 - f_{DOCmac}) + f_{DOCmac} \\cdot \\frac{Q_{C:N}^{PHY}}{Q_{C:N}^{MAC}} \\right]","title":"Total Alkalinity (TAl)"},{"location":"Model/Remineralisation/#phosphate","text":"Scaled similarly using C:P ratios: \\frac{dPO_4^{3-}{dt} = + R_{tot} \\cdot \\left[(1 - f_{DOCmac}) + f_{DOCmac} \\cdot \\frac{Q_{C:P}^{PHY}}{Q_{C:P}^{MAC}} \\right]","title":"Phosphate"},{"location":"Model/Remineralisation/#iron-from-macroalgae-only","text":"Iron is released as dissolved iron only from macroalgal DOC remineralization: \\frac{dDFe}{dt} = + R_{tot} \\cdot f_{DOCmac} \\cdot \\left( \\frac{1}{Q_{C:Fe}^{MAC}} \\right)","title":"Iron (from macroalgae only)"},{"location":"Model/Remineralisation/#variables","text":"Fortran Variable Documentation / Equation Name Description xdocmacdoc f_{\\text{mac}} = \\frac{\\text{DOC}_{\\text{MAC}}}{\\text{DOC} + \\text{DOC}_{\\text{MAC}}} Fraction of total DOC from macroalgae tr(:,:,:,jpdoc,...) \\text{DOC} Classical dissolved organic carbon tr(:,:,:,jpdocmac,...) \\text{DOC}_{\\text{MAC}} DOC from macroalgae tr(:,:,:,jpoxy,...) \\text{O}_2 Dissolved oxygen tr(:,:,:,jpno3,...) \\text{NO}_3^- Nitrate tr(:,:,:,jpdic,...) \\text{DIC} Dissolved inorganic carbon tr(:,:,:,jpnh4,...) \\text{NH}_4^+ Ammonium tr(:,:,:,jptal,...) \\text{TA} Total alkalinity tr(:,:,:,jppo4,...) \\text{PO}_4^{3-} Phosphate tr(:,:,:,jpfer,...) \\text{DFe} Dissolved iron qCN_phy Q_{\\text{C:N}}^{\\text{phy}} Phytoplankton carbon-to-nitrogen ratio qCN_mac Q_{\\text{C:N}}^{\\text{mac}} Macroalgae carbon-to-nitrogen ratio qCP_phy Q_{\\text{C:P}}^{\\text{phy}} Phytoplankton carbon-to-phosphorus ratio qCP_mac Q_{\\text{C:P}}^{\\text{mac}} Macroalgae carbon-to-phosphorus ratio qCFe_mac Q_{\\text{C:Fe}}^{\\text{mac}} Macroalgae carbon-to-iron ratio","title":"Variables"},{"location":"Model/model/","text":"General description of the Macroalgae module Initialisation with a seed on bathymetry Production of macroalgae Mortality Degradation of macroalgal detritus Sinking of detritus Remineralisation of macroalgal DOC Sedimentation of detritus","title":"General Description"},{"location":"Model/model/#general-description-of-the-macroalgae-module","text":"Initialisation with a seed on bathymetry Production of macroalgae Mortality Degradation of macroalgal detritus Sinking of detritus Remineralisation of macroalgal DOC Sedimentation of detritus","title":"General description of the Macroalgae module"}]}